<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Baroclinic Effects · VortexMethod.jl</title><meta name="title" content="Baroclinic Effects · VortexMethod.jl"/><meta property="og:title" content="Baroclinic Effects · VortexMethod.jl"/><meta property="twitter:title" content="Baroclinic Effects · VortexMethod.jl"/><meta name="description" content="Documentation for VortexMethod.jl."/><meta property="og:description" content="Documentation for VortexMethod.jl."/><meta property="twitter:description" content="Documentation for VortexMethod.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">VortexMethod.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary Conditions</a></li><li class="is-active"><a class="tocitem" href>Baroclinic Effects</a><ul class="internal"><li><a class="tocitem" href="#Physical-Background"><span>Physical Background</span></a></li><li><a class="tocitem" href="#Boussinesq-Approximation"><span>Boussinesq Approximation</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Validation:-Linear-Theory-Comparison"><span>Validation: Linear Theory Comparison</span></a></li><li><a class="tocitem" href="#Multi-Sheet-Simulations"><span>Multi-Sheet Simulations</span></a></li><li><a class="tocitem" href="#Kelvin–Helmholtz-with-Stratification"><span>Kelvin–Helmholtz with Stratification</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../dissipation/">Dissipation Models</a></li><li><a class="tocitem" href="../remeshing/">Remeshing</a></li><li><a class="tocitem" href="../parallelization/">Parallelization</a></li><li><a class="tocitem" href="../validation/">Validation</a></li><li><a class="tocitem" href="../usage/">Usage</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Baroclinic Effects</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Baroclinic Effects</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/subhk/VortexMethod.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/subhk/VortexMethod.jl/blob/main/docs/src/baroclinic.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Baroclinic-Vorticity-Generation"><a class="docs-heading-anchor" href="#Baroclinic-Vorticity-Generation">Baroclinic Vorticity Generation</a><a id="Baroclinic-Vorticity-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Baroclinic-Vorticity-Generation" title="Permalink"></a></h1><p>This page describes the treatment of density discontinuities and baroclinic vorticity generation, based on <a href="https://resolver.caltech.edu/CaltechETD:etd-05312006-165837">Stock (2006), §3.7</a>.</p><h2 id="Physical-Background"><a class="docs-heading-anchor" href="#Physical-Background">Physical Background</a><a id="Physical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Background" title="Permalink"></a></h2><div class="admonition is-info" id="Baroclinic-Vorticity-Generation-adf67a32da059be1"><header class="admonition-header">Baroclinic Vorticity Generation<a class="admonition-anchor" href="#Baroclinic-Vorticity-Generation-adf67a32da059be1" title="Permalink"></a></header><div class="admonition-body"><p>When a density interface exists in a flow under acceleration (gravity or otherwise), vorticity is generated at the interface. This <strong>baroclinic</strong> mechanism drives important instabilities like Rayleigh–Taylor and Richtmyer–Meshkov.</p></div></div><p>When a density interface exists in a flow under acceleration (gravity or otherwise), vorticity is generated at the interface. This <strong>baroclinic</strong> mechanism drives important instabilities:</p><ul><li><strong>Rayleigh–Taylor instability:</strong> Heavy fluid over light fluid under gravity</li><li><strong>Richtmyer–Meshkov instability:</strong> Shock-accelerated density interface</li><li><strong>Kelvin–Helmholtz with stratification:</strong> Shear layer with stabilizing/destabilizing buoyancy</li></ul><h2 id="Boussinesq-Approximation"><a class="docs-heading-anchor" href="#Boussinesq-Approximation">Boussinesq Approximation</a><a id="Boussinesq-Approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Boussinesq-Approximation" title="Permalink"></a></h2><div class="admonition is-info" id="Small-Density-Differences-f4a447d5d2fda17"><header class="admonition-header">Small Density Differences<a class="admonition-anchor" href="#Small-Density-Differences-f4a447d5d2fda17" title="Permalink"></a></header><div class="admonition-body"><p>The Boussinesq approximation assumes density differences are small (<span>$|A| \ll 1$</span>), so inertia is dominated by the mean density while buoyancy depends on the density difference.</p></div></div><p>In the Boussinesq limit (small density differences), the baroclinic source term in the vortex sheet strength equation is:</p><p class="math-container">\[\left(\frac{D\boldsymbol{\gamma}}{Dt}\right)_{\text{baroclinic}} = 2A\,\hat{\mathbf{n}} \times (\bar{\mathbf{a}} - \mathbf{g})\]</p><p>where:</p><ul><li><span>$A = (\rho_2 - \rho_1)/(\rho_1 + \rho_2)$</span> is the <strong>Atwood number</strong></li><li><span>$\hat{\mathbf{n}}$</span> is the interface normal (pointing from fluid 1 to fluid 2)</li><li><span>$\bar{\mathbf{a}}$</span> is the average interface acceleration</li><li><span>$\mathbf{g}$</span> is gravitational acceleration</li></ul><p>The corresponding circulation equation:</p><p class="math-container">\[\frac{D\Gamma}{Dt} = 2A\left(\frac{D\phi}{Dt} - \frac{1}{2}|\mathbf{u}|^2 + \frac{1}{8}|\Delta\mathbf{u}|^2 - \mathbf{g}\cdot\mathbf{x}\right)\]</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="Element-Data-Structure"><a class="docs-heading-anchor" href="#Element-Data-Structure">Element Data Structure</a><a id="Element-Data-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Element-Data-Structure" title="Permalink"></a></h3><p>Each triangular element stores its own local Atwood number. All elements in an interconnected sheet share the same value, though separate sheets may have different values.</p><h3 id="Vorticity-Update"><a class="docs-heading-anchor" href="#Vorticity-Update">Vorticity Update</a><a id="Vorticity-Update-1"></a><a class="docs-heading-anchor-permalink" href="#Vorticity-Update" title="Permalink"></a></h3><p>For each element <span>$i$</span> at the density interface:</p><p class="math-container">\[\Delta\boldsymbol{\alpha}_i = \Delta t \cdot 2\,a_i\,\theta_i\,\hat{\mathbf{n}}_i \times \hat{\mathbf{g}}\]</p><p>where:</p><ul><li><span>$a_i$</span> is the element area</li><li><span>$\theta_i = A \cdot g$</span> is the Boussinesq coefficient (Atwood number × gravity)</li><li><span>$\hat{\mathbf{n}}_i$</span> is the element normal</li><li><span>$\hat{\mathbf{g}}$</span> is the gravity direction</li></ul><p>This vector change in total vorticity is converted to edge circulations using the standard procedure (see <a href="../theory/#circulation-assignment">Theory</a>).</p><h3 id="Integration-with-Time-Stepping"><a class="docs-heading-anchor" href="#Integration-with-Time-Stepping">Integration with Time Stepping</a><a id="Integration-with-Time-Stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-Time-Stepping" title="Permalink"></a></h3><p>Baroclinic updates are applied at every sub-step of the time integration:</p><pre><code class="language-julia hljs">function rk2_step_with_baroclinic!(nodes, tri, eleGma, domain, gr, dt; atwood=0.0, gravity=[0,0,-1])
    # Stage 1: Compute velocities
    vel1 = node_velocities(eleGma, tri, nodes..., domain, gr)

    # Update positions to midpoint
    nodes_mid = nodes .+ 0.5 * dt .* vel1

    # Baroclinic source at midpoint
    if atwood != 0
        apply_baroclinic_source!(eleGma, tri, nodes_mid, atwood, gravity, 0.5*dt)
    end

    # Stage 2: Compute velocities at midpoint
    vel2 = node_velocities(eleGma, tri, nodes_mid..., domain, gr)

    # Full step
    nodes .+= dt .* vel2

    # Baroclinic source for full step
    if atwood != 0
        apply_baroclinic_source!(eleGma, tri, nodes, atwood, gravity, 0.5*dt)
    end
end</code></pre><h2 id="Validation:-Linear-Theory-Comparison"><a class="docs-heading-anchor" href="#Validation:-Linear-Theory-Comparison">Validation: Linear Theory Comparison</a><a id="Validation:-Linear-Theory-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Validation:-Linear-Theory-Comparison" title="Permalink"></a></h2><h3 id="Stable-Oscillation-(Light-over-Heavy)"><a class="docs-heading-anchor" href="#Stable-Oscillation-(Light-over-Heavy)">Stable Oscillation (Light over Heavy)</a><a id="Stable-Oscillation-(Light-over-Heavy)-1"></a><a class="docs-heading-anchor-permalink" href="#Stable-Oscillation-(Light-over-Heavy)" title="Permalink"></a></h3><p>For <span>$A &gt; 0$</span> (lighter fluid on top), a sinusoidally-perturbed interface oscillates:</p><p class="math-container">\[f(x,t) = F_0 \exp(ikx + it\sqrt{|{\theta}|k})\]</p><p>with period:</p><p class="math-container">\[\tau = \frac{2\pi}{\sqrt{|\theta|k}}\]</p><h3 id="Unstable-Growth-(Heavy-over-Light)"><a class="docs-heading-anchor" href="#Unstable-Growth-(Heavy-over-Light)">Unstable Growth (Heavy over Light)</a><a id="Unstable-Growth-(Heavy-over-Light)-1"></a><a class="docs-heading-anchor-permalink" href="#Unstable-Growth-(Heavy-over-Light)" title="Permalink"></a></h3><p>For <span>$A &lt; 0$</span> (heavier fluid on top, or heavy over light with gravity reversed), the amplitude grows exponentially:</p><p class="math-container">\[f_{\max} = F_0 \cosh(t\sqrt{|{\theta}|k})\]</p><h3 id="Test-Setup"><a class="docs-heading-anchor" href="#Test-Setup">Test Setup</a><a id="Test-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Test-Setup" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Computational domain [0:1]×[0:1]×[-4:4]
# Periodic in x,y; wall in z
domain = DomainSpec(1.0, 1.0, 8.0)
gr = GridSpec(15, 15, 120)  # or finer

# Initial perturbation: z = 0.01 sin(2πx) → k = 2π
# Boussinesq coefficient θ = 1

# Expected period (stable case):
τ_theory = 2π / √(2π)  # ≈ 2.507

# Expected growth (unstable case):
magnification(t) = cosh(t * √(2π))</code></pre><h3 id="Convergence"><a class="docs-heading-anchor" href="#Convergence">Convergence</a><a id="Convergence-1"></a><a class="docs-heading-anchor-permalink" href="#Convergence" title="Permalink"></a></h3><div class="admonition is-success" id="Kernel-Selection-8cd17d22a5bac439"><header class="admonition-header">Kernel Selection<a class="admonition-anchor" href="#Kernel-Selection-8cd17d22a5bac439" title="Permalink"></a></header><div class="admonition-body"><p>The M4&#39; kernel provides the lowest errors for baroclinic validation. Area-weighting and Peskin kernels show approximately first-order convergence.</p></div></div><p>The method shows approximately first-order convergence to analytical limits, with the M4&#39; kernel providing lowest errors. Regularization causes:</p><ul><li>Longer oscillation periods than theory (smoother = slower)</li><li>Smaller unstable growth rates than theory (regularization damps peaks)</li></ul><h2 id="Multi-Sheet-Simulations"><a class="docs-heading-anchor" href="#Multi-Sheet-Simulations">Multi-Sheet Simulations</a><a id="Multi-Sheet-Simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Sheet-Simulations" title="Permalink"></a></h2><p>Simulations can contain multiple separate vortex sheets, each with its own Atwood number:</p><pre><code class="language-julia hljs"># Example: Two-layer stratification
sheets = [
    (tri=tri_upper, eleGma=eleGma_upper, atwood=0.1),   # Upper interface
    (tri=tri_lower, eleGma=eleGma_lower, atwood=-0.1),  # Lower interface
]

for sheet in sheets
    apply_baroclinic_source!(sheet.eleGma, sheet.tri, nodes, sheet.atwood, gravity, dt)
end</code></pre><h2 id="Kelvin–Helmholtz-with-Stratification"><a class="docs-heading-anchor" href="#Kelvin–Helmholtz-with-Stratification">Kelvin–Helmholtz with Stratification</a><a id="Kelvin–Helmholtz-with-Stratification-1"></a><a class="docs-heading-anchor-permalink" href="#Kelvin–Helmholtz-with-Stratification" title="Permalink"></a></h2><p>Combining shear (initial vortex sheet strength) with stratification:</p><h3 id="Linear-Growth-Rate"><a class="docs-heading-anchor" href="#Linear-Growth-Rate">Linear Growth Rate</a><a id="Linear-Growth-Rate-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-Growth-Rate" title="Permalink"></a></h3><p>From Chandrasekhar (1961):</p><p class="math-container">\[n = \frac{ik\,\Delta u\,(\rho_2 - \rho_1)}{2(\rho_1 + \rho_2)} + \sqrt{\frac{k^2(\Delta u)^2\rho_1\rho_2}{(\rho_1+\rho_2)^2} - \frac{gk(\rho_2-\rho_1)}{\rho_1+\rho_2}}\]</p><h3 id="Stability-Criterion"><a class="docs-heading-anchor" href="#Stability-Criterion">Stability Criterion</a><a id="Stability-Criterion-1"></a><a class="docs-heading-anchor-permalink" href="#Stability-Criterion" title="Permalink"></a></h3><div class="admonition is-warning" id="Richardson-Number-b1abe5d9ef31878e"><header class="admonition-header">Richardson Number<a class="admonition-anchor" href="#Richardson-Number-b1abe5d9ef31878e" title="Permalink"></a></header><div class="admonition-body"><p>At the critical Richardson number <span>$Ri_c = 1/4$</span>, the shear layer transitions from stable to unstable. Below this value, shear dominates buoyancy.</p></div></div><p>The interface is unstable when:</p><p class="math-container">\[k(\Delta u)^2 &gt; \frac{g(\rho_2 - \rho_1)(\rho_1 + \rho_2)}{\rho_1\rho_2}\]</p><p>At the critical Richardson number, <span>$Ri_c = 1/4$</span>, the shear layer is marginally stable.</p><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Apply baroclinic vorticity source
apply_baroclinic_source!(eleGma, tri, nodeX, nodeY, nodeZ, atwood, gravity, dt)

# Time stepping with baroclinic terms
rk2_step!(nodeX, nodeY, nodeZ, tri, eleGma, domain, gr, dt;
          baroclinic=true, atwood=0.1, gravity=[0.0, 0.0, -1.0])</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Chandrasekhar, S. (1961). <em>Hydrodynamic and Hydromagnetic Stability</em>. Oxford University Press.</li><li>Stock, M. J. (2006). <em>A regularized inviscid vortex sheet method for three dimensional flows with density interfaces</em>. Ph.D. Thesis, California Institute of Technology.</li><li>Zalosh, R. G. (1976). Discretized simulation of vortex sheet evolution with buoyancy and surface tension effects. <em>AIAA Journal</em>, 14(11), 1517–1523.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../boundary_conditions/">« Boundary Conditions</a><a class="docs-footer-nextpage" href="../dissipation/">Dissipation Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 19 January 2026 23:01">Monday 19 January 2026</span>. Using Julia version 1.11.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
