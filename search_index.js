var documenterSearchIndex = {"docs":
[{"location":"parallelization/#Parallelization","page":"Parallelization","title":"Parallelization","text":"The implementation uses MPI to parallelize the most expensive parts of the pipeline.\n\ninfo: MPI-Based Parallelism\nThe parallelization strategy uses MPI with embarrassingly parallel work distribution for spreading and interpolation, avoiding complex halo exchanges or domain decomposition.","category":"section"},{"location":"parallelization/#Spreading-vorticity-to-the-grid","page":"Parallelization","title":"Spreading vorticity to the grid","text":"Each rank handles a strided subset of grid points (round-robin across the flattened (k,j,i) index ordering).\nFor each grid point, it collects contributions from nearby elements via the chosen kernel and periodic tiles.\nLocal contributions are accumulated in a rank-local buffer; a final MPI.Allreduce (SUM) builds the global grid vorticity.\n\nBenefits: embarrassingly parallel, no halo exchange, and no custom domain decomposition needed.","category":"section"},{"location":"parallelization/#Poisson-solve","page":"Parallelization","title":"Poisson solve","text":"note: Centralized Solve\nThe FFT-based Poisson solver currently runs on rank 0 and broadcasts results. For very large problems, consider PoissonAdvanced for distributed solvers.\n\nThe FFT-based Poisson solver currently runs on rank 0, computes the full solution (Ux,Uy,Uz), and broadcasts to all ranks.\nFor very large problems, PoissonAdvanced provides interfaces for iterative or multigrid solvers. A hybrid solver can try FFT first and fall back if the residual is above a threshold.","category":"section"},{"location":"parallelization/#Interpolation-to-nodes","page":"Parallelization","title":"Interpolation to nodes","text":"Each rank handles a strided subset of nodes and accumulates interpolated velocities from nearby grid cells using the same kernel family.\nPer-rank results are combined with MPI.Allreduce.","category":"section"},{"location":"parallelization/#Time-stepping-and-adaptivity","page":"Parallelization","title":"Time stepping and adaptivity","text":"Node velocities are computed in parallel, and RK2 updates are carried out locally with final periodic wraps per step.\nAdaptive dt is computed from the global maximum grid speed via MPI.Allreduce (MAX).","category":"section"},{"location":"parallelization/#Checkpointing-and-I/O","page":"Parallelization","title":"Checkpointing and I/O","text":"tip: Rank 0 I/O\nAll file I/O is performed on rank 0 to avoid contention and ensure consistent checkpoint files.\n\nCheckpoints (CSV, MAT, JLD2) are written on rank 0 to avoid file contention. Rank 0 aggregates necessary data and saves.","category":"section"},{"location":"parallelization/#Figures-from-the-thesis","page":"Parallelization","title":"Figures from the thesis","text":"Recommended figures:\n\nSchematic of the Lagrangian–Eulerian pipeline.\nStrong/weak scaling curves (if available).\n\nPlace images extracted from the thesis into docs/src/assets/ and reference here.","category":"section"},{"location":"api/#API-Reference","page":"API","title":"API Reference","text":"This page lists the main user-facing entry points. See docstrings and source for details.","category":"section"},{"location":"api/#Domain-and-grid","page":"API","title":"Domain and grid","text":"DomainSpec(Lx,Ly,Lz), GridSpec(nx,ny,nz)\ndefault_domain(), default_grid()\ngrid_vectors(domain, gr), grid_spacing(domain, gr), grid_mesh(domain, gr)\nwrap_point(x,y,z, domain), wrap_nodes!(nodeX,nodeY,nodeZ, domain)","category":"section"},{"location":"api/#Kernels","page":"API","title":"Kernels","text":"VortexMethod.Kernels:\n\nTypes: KernelType, PeskinStandard, PeskinCosine, M4Prime, AreaWeighting\nHelpers: kernel_function, kernel_support_radius","category":"section"},{"location":"api/#Spreading-and-interpolation-(MPI)","page":"API","title":"Spreading and interpolation (MPI)","text":"VortexMethod.Peskin3D:\n\nspread_vorticity_to_grid_mpi(eleGma, triXC, triYC, triZC, domain, gr)\ninterpolate_node_velocity_mpi(Ux, Uy, Uz, nodeX, nodeY, nodeZ, domain, gr)\nKernel variants: spread_vorticity_to_grid_kernel_mpi, interpolate_node_velocity_kernel_mpi","category":"section"},{"location":"api/#Poisson-solvers","page":"API","title":"Poisson solvers","text":"VortexMethod.Poisson3D:\n\ncurl_rhs_centered(VorX,VorY,VorZ, dx,dy,dz)\npoisson_velocity_fft(u_rhs,v_rhs,w_rhs, domain; mode=:spectral)\npoisson_velocity_fft_mpi(u_rhs,v_rhs,w_rhs, domain; mode=:spectral)\n\nVortexMethod.PoissonAdvanced:\n\nTypes: FFTSolver, IterativeSolver, MultigridSolver, HybridSolver\nBCs: PeriodicBC, DirichletBC, NeumannBC\nsolve_poisson!(solver, u_rhs, v_rhs, w_rhs, domain)\nsolve_poisson_adaptive!(u_rhs, v_rhs, w_rhs, domain; bc=PeriodicBC())","category":"section"},{"location":"api/#Time-stepping","page":"API","title":"Time stepping","text":"VortexMethod.TimeStepper:\n\nnode_velocities(eleGma, triXC, triYC, triZC, nodeX, nodeY, nodeZ, domain, gr; poisson_mode=:spectral)\nrk2_step!(nodeX, nodeY, nodeZ, tri, eleGma, domain, gr, dt; kwargs...)\nrk2_step_with_dissipation!(...; dissipation_model=NoDissipation(), kwargs...)\nVelocity helpers: grid_velocity(...), make_velocity_sampler(...)","category":"section"},{"location":"api/#Dissipation-models","page":"API","title":"Dissipation models","text":"VortexMethod.Dissipation:\n\nTypes: DissipationModel, NoDissipation, SmagorinskyModel, DynamicSmagorinsky, VortexStretchingDissipation, MixedScaleModel\nFunctions: apply_dissipation!(...), compute_eddy_viscosity(...), filter_width(...)","category":"section"},{"location":"api/#Remeshing","page":"API","title":"Remeshing","text":"VortexMethod.Remesh:\n\nremesh_pass!(nodeX,nodeY,nodeZ, tri, ds_max, ds_min; domain, ...)\nUtilities: detect_max_edge_length, detect_min_edge_length\n\nVortexMethod.RemeshAdvanced:\n\ncompute_mesh_quality(triXC,triYC,triZC, domain) (periodic) and variants\nflow_adaptive_remesh!(nodeX,nodeY,nodeZ, tri, velocity_field, domain; thresholds...)\ncurvature_based_remesh!(...), anisotropic_remesh!(...), periodic-aware","category":"section"},{"location":"api/#Vortex-sheets","page":"API","title":"Vortex sheets","text":"VortexMethod.VortexSheets:\n\nTypes: LagrangianSheet, EulerianSheet, HybridSheet\nEvolution: evolve_sheet!(sheet, evolution, velocity_field, dt, domain) with Classical, Adaptive, or HighOrder strategies\nAnalysis: compute_sheet_curvature(...), detect_sheet_rollup(...)\nReconnection/smoothing: check_sheet_reconnection!(..., domain), reconnect_sheet_nodes!(..., domain), smooth_local_curvature!(..., domain)","category":"section"},{"location":"api/#Checkpointing","page":"API","title":"Checkpointing","text":"VortexMethod.Checkpoint:\n\nSingle-snapshot: save_checkpoint! (CSV), save_checkpoint_mat! (MAT), save_checkpoint_jld2! (JLD2)\nTime series (JLD2): save_state_timeseries!, series_times, load_series_snapshot, load_series_nearest_time\nHelpers: mesh_stats(...) with periodic overload when domain is provided","category":"section"},{"location":"usage/#Usage-Guide","page":"Usage","title":"Usage Guide","text":"","category":"section"},{"location":"usage/#Installation","page":"Usage","title":"Installation","text":"tip: First-Time Setup\nMake sure to instantiate the project before your first use to download all dependencies.\n\njulia --project -e 'using Pkg; Pkg.instantiate()'","category":"section"},{"location":"usage/#Running-examples-with-MPI","page":"Usage","title":"Running examples with MPI","text":"mpirun -n 4 julia --project examples/simple3d.jl\nmpirun -n 4 julia --project examples/kh3d.jl\nmpirun -n 4 julia --project examples/advanced_kh3d.jl","category":"section"},{"location":"usage/#Core-API","page":"Usage","title":"Core API","text":"Domain/grid: DomainSpec(Lx,Ly,Lz), GridSpec(nx,ny,nz), default_domain(), default_grid()\nPeriodic helpers: wrap_point(x,y,z, domain), wrap_nodes!(nodeX,nodeY,nodeZ, domain)\nSpreading/interpolation (MPI): spread_vorticity_to_grid_mpi, interpolate_node_velocity_mpi\nPoisson: poisson_velocity_fft / _mpi (periodic), or see PoissonAdvanced for alternatives\nTime stepping: rk2_step!, rk2_step_with_dissipation!; helper node_velocities\nVelocity reuse: grid_velocity to compute (Ux,Uy,Uz) once; make_velocity_sampler to build (x,y,z)->(u,v,w) closures\nRemeshing: VortexMethod.Remesh.* and VortexMethod.RemeshAdvanced.*\nVortex sheets: see VortexMethod.VortexSheets\nCheckpoints: save_checkpoint!, save_state!, save_state_timeseries!","category":"section"},{"location":"usage/#Minimal-workflow","page":"Usage","title":"Minimal workflow","text":"info: Basic Simulation Loop\nA typical simulation involves: initialize mesh → time step → remesh → checkpoint → repeat.\n\nBuild or load a triangulated sheet (node arrays + tri connectivity). Initialize eleGma (nt×3).\nCompute node velocities and advance with rk2_step! (or the variant with dissipation).\nPeriodically remesh using the baseline or advanced methods. Preserve circulation via node_circulation_from_ele_gamma and ele_gamma_from_node_circ.\nSave checkpoints regularly (rank 0) via save_state! or save_state_timeseries!.","category":"section"},{"location":"usage/#Advanced-remeshing-recipe","page":"Usage","title":"Advanced remeshing recipe","text":"Ux,Uy,Uz = grid_velocity(eleGma, triXC, triYC, triZC, domain, gr)\nvel = make_velocity_sampler(eleGma, triXC, triYC, triZC, domain, gr)\ntri_new, changed = VortexMethod.RemeshAdvanced.flow_adaptive_remesh!(\n    nodeX, nodeY, nodeZ, tri, vel, domain;\n    max_aspect_ratio=3.0, min_angle_quality=0.4, min_jacobian_quality=0.4,\n    max_skewness=0.8, grad_threshold=0.2, curvature_threshold=0.6,\n)","category":"section"},{"location":"usage/#Periodicity-and-particle-management","page":"Usage","title":"Periodicity and particle management","text":"warning: Always Wrap Nodes\nAfter inserting, deleting, or moving nodes manually, always call wrap_nodes! to ensure positions remain within the periodic domain.\n\nAfter inserting, deleting, or moving nodes manually, call wrap_nodes! to keep positions in-range.\nUse wrap_point for single updates (e.g., after reconnection).","category":"section"},{"location":"usage/#Figures-from-the-thesis","page":"Usage","title":"Figures from the thesis","text":"You can place figures into docs/src/assets/ and reference them in Markdown with ![](assets/...). If you provide figure numbers/pages, we can add captions and cross-references.","category":"section"},{"location":"remeshing/#Remeshing","page":"Remeshing","title":"Remeshing","text":"The sheet mesh must maintain resolution and element quality as it deforms under Lagrangian motion. Without remeshing, vortex sheets become bent and contorted, losing accuracy. This page describes the edge-splitting and node-merging algorithms based on Stock (2006), §3.4–3.5.","category":"section"},{"location":"remeshing/#Why-Remeshing-is-Essential","page":"Remeshing","title":"Why Remeshing is Essential","text":"info: Mesh Quality Degradation\nThe proposed discretization method has ideal conservation properties under planar strain. However, in real flows the mesh degrades as elements stretch, fold, and rotate with the Lagrangian motion.\n\nThe proposed discretization method has ideal conservation properties under planar strain—even if triangle nodes become separated beyond the grid scale. However, in real flows:\n\nVortex sheets fold and roll up\nElements experience non-uniform strain\nTriangle aspect ratios degrade\nResolution becomes insufficient in high-curvature regions\n\nTwo complementary operations address these issues:\n\nEdge Splitting: Inserts nodes in long edges, maintaining resolution\nNode Merging: Removes close nodes, simplifying the mesh","category":"section"},{"location":"remeshing/#Edge-Splitting-Algorithm","page":"Remeshing","title":"Edge Splitting Algorithm","text":"When triangle edges become too long (> Delta_textsplit approx delta), they are split to maintain resolution.","category":"section"},{"location":"remeshing/#Splitting-Procedure","page":"Remeshing","title":"Splitting Procedure","text":"At every time step:\n\nReset all node and element flags, recompute surface normal vectors\nFlag all elements whose longest edge exceeds Delta_textsplit\nSort flagged edges by length (longest first)\nFor each flagged edge:\nFind all elements sharing that edge\nCreate a new node at the edge midpoint\nSplit each sharing element into two new elements\nAssign vortex sheet strength to new elements (see below)\nRemove original elements\n\nThis produces a valid connected mesh with no under-resolved regions.","category":"section"},{"location":"remeshing/#Midpoint-Selection-Methods","page":"Remeshing","title":"Midpoint Selection Methods","text":"tip: Choosing a Midpoint Method\nUse geometric midpoint for volume conservation, cubic spline for curved surfaces, and cylindrical projection for roll-up regions where accuracy in high-curvature areas is critical.\n\nThree methods for positioning new nodes:","category":"section"},{"location":"remeshing/#1.-Geometric-Midpoint-(Default)","page":"Remeshing","title":"1. Geometric Midpoint (Default)","text":"Simply average the endpoint positions:\n\nmathbfx_3 = fracmathbfx_1 + mathbfx_22\n\nPros: Exactly conserves enclosed volume\nCons: Poor at capturing curvature","category":"section"},{"location":"remeshing/#2.-Cubic-Spline-Fit","page":"Remeshing","title":"2. Cubic Spline Fit","text":"Fits a cubic spline between endpoints using surface normal information:\n\nCalculate surface normal at each endpoint hatmathbfn_j as weighted average of adjacent element normals:\n\nhatmathbfn_j = textnormleft(sum_e=1^N_j hatmathbfn_e phi_jeright)\n\nwhere phi_je is the angle subtended at node j by element e.\n\nCompute tangential projection mathbfP_j = mathbfI - hatmathbfn_jhatmathbfn_j^T\nBuild spline coefficients and evaluate at midpoint\n\nPros: Better approximation of curved surfaces\nCons: More computation","category":"section"},{"location":"remeshing/#3.-Cylindrical-Projection","page":"Remeshing","title":"3. Cylindrical Projection","text":"Fits a cylinder to the edge using endpoint normals:\n\nmathbfx_3 = fracmathbfx_1 + mathbfx_22 + dfrachatmathbfn_1 + hatmathbfn_2hatmathbfn_1 + hatmathbfn_2\n\nwhere d is computed from the angle between normals and the projected edge length:\n\ntheta = frac12cos^-1(hatmathbfn_1 cdot hatmathbfn_2) quad d = fracl2left(frac1sintheta - frac1tanthetaright)\n\nPros: Excellent for roll-up regions\nCons: Cannot be used across disconnected sheets","category":"section"},{"location":"remeshing/#Circulation-Assignment-to-Split-Elements","page":"Remeshing","title":"Circulation Assignment to Split Elements","text":"warning: Non-Coplanar Children\nWhen using spline or cylindrical midpoints, child elements are not coplanar. Special care is needed to preserve circulation during the split operation.\n\nWhen splitting an edge, the child elements must receive appropriate vortex sheet strength. For coplanar children:\n\nboldsymbolgamma_textparent = boldsymbolgamma_textchild1 = boldsymbolgamma_textchild2\n\nFor non-coplanar children (spline/cylindrical midpoints):\n\nCreate new node at geometric midpoint first\nApply circulation assignment to coplanar children\nMove node to perturbed position (stretches vortex lines without changing circulation)","category":"section"},{"location":"remeshing/#Baseline-pass-(VortexMethod.Remesh.remesh_pass!)","page":"Remeshing","title":"Baseline pass (VortexMethod.Remesh.remesh_pass!)","text":"Detect long edges and perform 1→4 splits using periodic midpoints on all three edges of any marked triangle (and its neighbor sharing an edge).\nPerform edge flips to remove very short edges and reduce anisotropy.\nOptionally collapse edges persistently below ds_min by inserting a periodic midpoint and replacing both endpoints.\nCompact node indices (optional) and finally wrap all nodes to the periodic domain using wrap_nodes!.\n\nInputs are derived from grid spacing: ds_max ≈ O(max(dx,dy)), ds_min ≈ O(0.05 max(dx,dy)).","category":"section"},{"location":"remeshing/#Node-Merging-Algorithm","page":"Remeshing","title":"Node Merging Algorithm","text":"note: Complementary to Splitting\nEdge splitting alone can produce numerous thin, low-quality triangles. Node merging simplifies the mesh by combining close node pairs, maintaining element quality.\n\nEdge splitting alone can produce numerous thin, low-quality triangles. Node merging simplifies the mesh by combining close node pairs.","category":"section"},{"location":"remeshing/#Types-of-Merging","page":"Remeshing","title":"Types of Merging","text":"In-Sheet Merge: Only merges nodes that share at least one element (same connected sheet)\nFull Merge: Merges any close node pairs, regardless of connectivity (can connect separate sheets)","category":"section"},{"location":"remeshing/#Merging-Procedure","page":"Remeshing","title":"Merging Procedure","text":"Node merging operates in conjunction with edge splitting:\n\nReset all node and element flags, recompute surface normals\nBuild list of node pairs within distance Delta_textmerge\nSort by distance (closest first)\nFor each node pair (node 1 and node 2):\nSkip if either node was recently modified\nCompute new node position\nCreate lists of:\nElements containing only node 1\nElements containing only node 2\nElements containing both (will be collapsed and removed)\nElement pairs that will become coincident\nSave vortex sheet strengths from affected elements\nRemove collapsed elements\nReplace node 2 with node 1 in all elements\nDelete node 2\nRelocate node 1 to computed position\nRedistribute saved vorticity to remaining elements","category":"section"},{"location":"remeshing/#Effect-on-Element-Count","page":"Remeshing","title":"Effect on Element Count","text":"Remeshing Mode Element Count Scaling Notes\nNo remeshing N sim t^3 Unsustainable\nSplit only N sim t^3 (thin triangles) Many poor-quality elements\nIn-sheet merge N sim A_textsheet sim t^2 Good quality maintenance\nFull merge N sim A_textsheet Can reconnect sheets\n\nThe in-sheet merging case shows that element count increases proportionally to surface area—indicating consistent element sizes are maintained.","category":"section"},{"location":"remeshing/#Advanced,-thesis-style-refinement-(VortexMethod.RemeshAdvanced.flow_adaptive_remesh!)","page":"Remeshing","title":"Advanced, thesis-style refinement (VortexMethod.RemeshAdvanced.flow_adaptive_remesh!)","text":"Uses strict thresholds designed to match the thesis:","category":"section"},{"location":"remeshing/#Periodic-Quality-Metrics-(Minimum-Image)","page":"Remeshing","title":"Periodic Quality Metrics (Minimum Image)","text":"Max aspect ratio: aspect_ratio ≤ max_aspect_ratio (default 3.0)\nMax skewness: skewness ≤ max_skewness (default 0.8)\nMin angle quality: angle_quality ≥ min_angle_quality (default 0.4), where 1 = perfect 60° minimum angle\nMin Jacobian quality: jacobian_quality ≥ min_jacobian_quality (default 0.4)","category":"section"},{"location":"remeshing/#Flow-Based-Indicators","page":"Remeshing","title":"Flow-Based Indicators","text":"Velocity gradient magnitude: nablamathbfU_F geq grad_threshold (default 0.2) ⇒ refine\nCurvature (dihedral angle): angle between adjacent triangle normals ≥ curvature_threshold (default 0.6 rad) ⇒ refine\n\nAny single criterion marks an element for refinement. Refinement uses 1→4 splitting with periodic midpoints. After refinement the node coordinates are wrapped.","category":"section"},{"location":"remeshing/#Curvature-/Anisotropy-based-passes","page":"Remeshing","title":"Curvature-/Anisotropy-based passes","text":"curvature_based_remesh!: targets high-dihedral-angle regions to preserve sharp roll-up fronts.\nanisotropic_remesh!: probes a supplied velocity_field(x,y,z) and refines where gradients are strong.","category":"section"},{"location":"remeshing/#Conservation-of-circulation-across-remesh","page":"Remeshing","title":"Conservation of circulation across remesh","text":"tip: Circulation Conservation\nRemeshing preserves discrete circulation by computing node circulations from the old mesh and reconstructing element circulations on the new geometry.\n\nWe compute node circulations from eleGma on the old mesh, then reconstruct eleGma on the new geometry:\n\nnodeTau = node_circulation_from_ele_gamma(tri_old, eleGma_old)\neleGma_new = ele_gamma_from_node_circ(nodeTau, tri_new)\n\nThis preserves the discrete circulation across re-meshing operations.","category":"section"},{"location":"remeshing/#Figures-from-the-thesis","page":"Remeshing","title":"Figures from the thesis","text":"Add quality metrics illustrations and sheet roll-up examples from the thesis PDF into docs/src/assets/ and reference them here.\n\nFigure 3.26 (remeshing/quality illustration; suggested filename: fig_3_26.png):\n\n(Image: )\n\nFigure 3.26: Remeshing and mesh-quality metrics (aspect ratio, skewness, angle and Jacobian quality) used to trigger refinement.\n\nFigure 3.52 (curvature/flow-adaptive example; suggested filename: fig_3_52.png):\n\n(Image: )\n\nFigure 3.52: Curvature- and flow-adaptive refinement highlighting high-dihedral-angle regions and strong velocity-gradient zones.\n\nAdd brief captions describing what each figure illustrates once extracted.","category":"section"},{"location":"theory/#Theory-Overview","page":"Theory","title":"Theory Overview","text":"This package implements a 3D Lagrangian vortex sheet method based on the numerical methods developed in Stock (2006).\n\nThe core ideas are:\n\nVorticity is carried on a moving, triangulated sheet (Lagrangian elements). Each triangular element stores scalar-valued circulations on its edges, which can be converted to vortex sheet strength or total vorticity.\nTo compute velocities, element vorticity is spread to a regular 3D grid using a smooth, compactly-supported kernel. The resulting grid vorticity field is converted to a velocity field by solving a Poisson equation via FFTs.\nGrid velocities are interpolated back to the Lagrangian nodes. Time integration moves nodes forward and updates element strengths consistent with conserved circulation and optional baroclinic sources or subfilter dissipation.\n\n","category":"section"},{"location":"theory/#Governing-Equations","page":"Theory","title":"Governing Equations","text":"info: Key Physical Insight\nUnlike standard vorticity methods, the vortex sheet formulation includes an in-sheet dilatation term that accounts for area changes of the sheet. This allows circulation (not just vorticity) to be the primary conserved quantity.","category":"section"},{"location":"theory/#Vortex-Sheet-Strength-Evolution","page":"Theory","title":"Vortex Sheet Strength Evolution","text":"The fundamental equation governing the dynamic evolution of vortex sheet strength is:\n\nfracDboldsymbolgammaDt = underbraceboldsymbolgamma cdot nablamathbfu_textstretch - underbraceboldsymbolgamma(mathbfP cdot nabla cdot mathbfu)_textdilatation + underbrace2Ahatmathbfn times (barmathbfa - mathbfg)_textbaroclinic\n\nwhere:\n\nboldsymbolgamma is the vortex sheet strength\nmathbfP = mathbfI - hatmathbfnhatmathbfn^T is the tangential projection operator\nA is the Atwood number (density ratio)\nhatmathbfn is the sheet normal\nbarmathbfa is the average acceleration, mathbfg is gravitational acceleration\n\nThe dilatation term distinguishes the vortex sheet strength equation from the standard vorticity evolution equation.","category":"section"},{"location":"theory/#Circulation-Evolution","page":"Theory","title":"Circulation Evolution","text":"The equivalent equation for circulation (which notably contains no vortex stretching term):\n\nfracDGammaDt = 2Aleft(fracDphiDt - frac12mathbfu^2 + frac18Deltamathbfu^2 - mathbfgcdotmathbfxright)\n\ntip: Conservation Property\nIn homogeneous (A = 0), inviscid flow, circulation is exactly conserved: DGammaDt = 0. This is the fundamental reason for using circulation-based discretization.","category":"section"},{"location":"theory/#Kinematic-Velocity-Equation","page":"Theory","title":"Kinematic Velocity Equation","text":"The velocity field is related to the vorticity field through:\n\nnabla^2mathbfu = -nabla times boldsymbolomega\n\nThis vector Poisson equation is solved on a regular grid using FFT-based spectral methods.\n\n","category":"section"},{"location":"theory/#Element-Discretization","page":"Theory","title":"Element Discretization","text":"note: Why Triangles?\nTriangular elements provide a flexible, unstructured representation of arbitrarily-shaped vortex sheets. Unlike vortex filaments or particles, triangles can naturally represent both stretching along vorticity and transverse strain.","category":"section"},{"location":"theory/#Triangular-Elements-with-Edge-Circulations","page":"Theory","title":"Triangular Elements with Edge Circulations","text":"The vortex sheet is discretized into flat triangular elements, each defined by connectivity to three Lagrangian nodes. Each triangular element p stores scalar-valued circulations Gamma_p13 on its edges.\n\nThe key relationship between different vorticity representations:\n\nboldsymbolalpha_p = v_pboldsymbolomega_p = a_pboldsymbolgamma_p = sum_i=1^3 Gamma_piDeltamathbfl_pi\n\nwhere:\n\nv_p is element volume (with regularization thickness)\na_p is element area\nboldsymbolomega_p is vorticity\nboldsymbolgamma_p is vortex sheet strength\nDeltamathbfl_pi are the edge vectors","category":"section"},{"location":"theory/#Circulation-Assignment","page":"Theory","title":"Circulation Assignment","text":"When setting edge circulations from a given total vorticity, the following overconstrained system is solved:\n\nbeginbmatrix\nDelta l_p1x  Delta l_p2x  Delta l_p3x \nDelta l_p1y  Delta l_p2y  Delta l_p3y \nDelta l_p1z  Delta l_p2z  Delta l_p3z \n1  1  1\nendbmatrix\nbeginpmatrix\nGamma_p1 \nGamma_p2 \nGamma_p3\nendpmatrix\n=\nbeginpmatrix\nalpha_px \nalpha_py \nalpha_pz \n0\nendpmatrix\n\nWhen the total vorticity is planar to the triangular element, the same total vorticity can be recovered. If not planar, the vorticity is reoriented to lie in the element plane.\n\nwarning: Non-Planar Vorticity\nWhen the desired vorticity is not in the plane of the triangle, the solver will project it onto the element plane. This is physically correct for a thin vortex sheet but means that out-of-plane vorticity components cannot be exactly represented on a single element.\n\n","category":"section"},{"location":"theory/#Mathematical-Pipeline","page":"Theory","title":"Mathematical Pipeline","text":"info: Algorithm Overview\nThe complete algorithm consists of five stages executed every time step, forming a Lagrangian-Eulerian-Lagrangian cycle.\n\nStage Operation Description\n1 Spreading Lagrangian → Eulerian vorticity transfer\n2 Curl RHS Compute right-hand side for Poisson equation\n3 Poisson Solve FFT-based spectral inversion\n4 Interpolation Eulerian → Lagrangian velocity transfer\n5 Time Step RK2 integration with optional physics","category":"section"},{"location":"theory/#1.-Spreading-(Lagrangian-Eulerian)","page":"Theory","title":"1. Spreading (Lagrangian → Eulerian)","text":"The vorticity field is created by interpolating element strengths onto a regular grid:\n\nboldsymbolomega(mathbfx) = frac1Delta x^3 sum_i=1^N fraca_iboldsymbolgamma_iM sum_j=1^M tildedeltaleft(fracmathbfx - mathbfx_ijDelta xright)\n\nwhere:\n\nN is the number of triangular elements\nM is the number of sub-triangle partitions (for smooth spreading)\ntildedelta is the particle-grid operator (interpolation kernel)\nmathbfx_ij is the center of sub-triangle j of element i\n\nEach triangle is subdivided into M equal-area sub-elements to ensure smoothness when elements span multiple grid cells.","category":"section"},{"location":"theory/#2.-Curl-RHS-on-the-Grid","page":"Theory","title":"2. Curl RHS on the Grid","text":"Given vorticity boldsymbolomega = (omega_x omega_y omega_z) on the grid, the RHS of the vector Poisson equation is -nablatimesboldsymbolomega, computed using second-order centered finite differences.","category":"section"},{"location":"theory/#3.-Poisson-Solve","page":"Theory","title":"3. Poisson Solve","text":"Spectral inversion in Fourier space with full 3D FFT. The zero-mean constraint is enforced by setting the k=0 mode to zero.","category":"section"},{"location":"theory/#4.-Interpolation-(Eulerian-Lagrangian)","page":"Theory","title":"4. Interpolation (Eulerian → Lagrangian)","text":"The same family of kernels interpolates grid velocity back to node positions with periodic tiling.","category":"section"},{"location":"theory/#5.-Time-Stepping","page":"Theory","title":"5. Time Stepping","text":"Two-stage RK2 with optional dissipation models. Adaptive Delta t via CFL-like condition using maximum grid speed. Baroclinic sources update element vorticity between stages.\n\n","category":"section"},{"location":"theory/#Interpolation-Kernels","page":"Theory","title":"Interpolation Kernels","text":"info: Role of Kernels\nThe interpolation kernel serves as a regularization of the singular Biot-Savart integral. Larger kernel support produces smoother fields but at higher computational cost. The kernel also acts as an implicit low-pass filter for LES-style simulations.\n\nThe kernel module (VortexMethod.Kernels) provides interchangeable, compactly supported weighting functions. Most 3D rectangular interpolation methods are tensor products of 1D functions:\n\ntildedeltaleft(fracmathbfx - mathbfx(s)Delta xright) = deltaleft(fracx - x(s)Delta xright) deltaleft(fracy - y(s)Delta yright) deltaleft(fracz - z(s)Delta zright)","category":"section"},{"location":"theory/#Area-Weighting-(Cloud-In-Cell)","page":"Theory","title":"Area-Weighting (Cloud-In-Cell)","text":"The simplest method, originating from the convolution of two top-hat functions:\n\ndelta(x) = begincases\n1 - x   x leq 1 \n0   x  1\nendcases\n\nSupport: 2 grid points per dimension (8 evaluations total)\nAccuracy: First-order\nUsage: AreaWeighting(delr=1.0)","category":"section"},{"location":"theory/#M4'-Kernel","page":"Theory","title":"M4' Kernel","text":"A B-spline-like kernel from Monaghan (1985):\n\ndelta(x) = begincases\n0   x  2 \nfrac12(2-x)^2(1-x)   1 leq x leq 2 \n1 - frac5x^22 + frac3x^32   x leq 1\nendcases\n\nSupport: 4 grid points per dimension (64 evaluations total)\nAccuracy: Third-order\nUsage: M4Prime(delr=2.0)","category":"section"},{"location":"theory/#Peskin-Function","page":"Theory","title":"Peskin Function","text":"A smoothing kernel with variable radius varepsilon:\n\ndelta(x) = begincases\nfrac12varepsilonleft1 + cosleft(fracpi xvarepsilonright)right   x leq varepsilon \n0   x  varepsilon\nendcases\n\nSupport: Tunable via varepsilon (typically 2–4 grid spacings)\nAccuracy: First-order, but smoother than area-weighting\nUsage: PeskinStandard(delr=4.0), PeskinCosine(delr=3.0)","category":"section"},{"location":"theory/#Kernel-Selection-Guidelines","page":"Theory","title":"Kernel Selection Guidelines","text":"Kernel Support Accuracy Speed Smoothness Best For\nArea-Weighting 2Δx 1st Fastest Low Quick tests\nM4' 4Δx 3rd Moderate Good Production runs\nPeskin (ε=2) 4Δx 1st Moderate Excellent Sensitive flows\nPeskin (ε=3) 6Δx 1st Slower Best High-quality visualization\n\ntip: Recommended Kernel\nThe M4' kernel provides the best accuracy-to-cost ratio for most simulations. Use larger Peskin radii when smooth vorticity fields are essential.\n\n","category":"section"},{"location":"theory/#Remeshing-Notions","page":"Theory","title":"Remeshing Notions","text":"note: See Also\nFor detailed algorithms, see the Remeshing page.\n\nLagrangian mesh quality degrades over time as nodes move and the sheet rolls up. Two complementary paths are implemented:\nBaseline length/flip/collapse pass (simple and fast), and\nAdvanced quality- and flow-aware refinement.\nThe advanced method uses periodic, minimum-image metrics to evaluate shape quality and local curvature; it also uses the Frobenius norm of the velocity gradient from a cached grid velocity to detect under-resolved regions.","category":"section"},{"location":"theory/#Figures-from-the-thesis","page":"Theory","title":"Figures from the thesis","text":"Place figures (e.g., kernel shapes, flow schematics, sheet roll-up) from the thesis PDF (mstock_dissertation.pdf) into docs/src/assets/.\n\nThesis figures to include here:\n\nFigure 1.23 (theory overview; suggested filename: fig_1_23.png):\n\n(Image: )\n\nFigure 1.23: High-level overview of the Lagrangian–Eulerian vortex method pipeline (spreading → curl RHS → Poisson → interpolation → time stepping). \n\nFigure 3.19 (supporting theory/parallel pipeline; suggested filename: fig_3_19.png):\n\n(Image: )\n\nFigure 3.19: Parallelization sketch showing MPI distribution for spreading/interpolation and centralized Poisson solve/broadcast.\n\nAdd short captions below each image once extracted.","category":"section"},{"location":"validation/#Validation","page":"Validation","title":"Validation","text":"This page describes validation test cases and comparisons with analytical solutions, following Stock (2006), §3.1.2, §3.4.4–3.4.5, §3.7.2.","category":"section"},{"location":"validation/#Element-Discretization-Tests","page":"Validation","title":"Element Discretization Tests","text":"info: Fundamental Validation\nThese tests verify the core discretization properties: conservation of circulation and correct handling of vortex stretching and dilatation terms.","category":"section"},{"location":"validation/#Stretch-Parallel-to-Vorticity","page":"Validation","title":"Stretch Parallel to Vorticity","text":"A flat vortex sheet with boldsymbolgamma(t=0) = 10hatmathbfj is subjected to an artificial velocity field causing stretch parallel to the vorticity direction.\n\nExpected result: partialboldsymbolgammapartial t = 0 (constant vortex sheet strength)\n\nThis test validates that the circulation-based discretization correctly handles the interplay between vortex stretching and the in-sheet dilatation term.","category":"section"},{"location":"validation/#Stretch-Transverse-to-Vorticity","page":"Validation","title":"Stretch Transverse to Vorticity","text":"A flat vortex sheet with boldsymbolgamma(t=0) = 10hatmathbfi experiences strain transverse to the vorticity direction.\n\nExpected behavior:\n\nPeak extensional strain (y=0.25): gamma_x = e^-2pi t (exponential decay)\nPeak compressional strain (y=0.75): gamma_x = e^+2pi t (exponential growth)\n\nThis test verifies that the method handles transverse strain—something neither standard vortex filament nor vortex particle methods can easily account for.","category":"section"},{"location":"validation/#Vortex-Ring-Circulation-Conservation","page":"Validation","title":"Vortex Ring Circulation Conservation","text":"tip: Canonical Test Case\nThe vortex ring provides an excellent test of circulation conservation because the analytical solution is known and the geometry exercises both stretching and curvature.","category":"section"},{"location":"validation/#Setup","page":"Validation","title":"Setup","text":"A unit-radius sphere centered at the origin with initial vortex sheet strength satisfying the no-through-flow condition in potential flow:\n\nboldsymbolgamma = -frac32r(hatmathbfn times mathbfU_infty)\n\nFor mathbfU_infty = -hatmathbfk, this gives Gamma_textring = 3.","category":"section"},{"location":"validation/#Circulation-Measurement","page":"Validation","title":"Circulation Measurement","text":"The vortex ring circulation is computed as:\n\nGamma_textring = sum_p=1^N frac12pimathbfx_p^2 sum_i=1^3 Gamma_pi(Deltamathbfl_pi times mathbfx_p) cdot hatmathbfk","category":"section"},{"location":"validation/#Expected-Results","page":"Validation","title":"Expected Results","text":"Initial discretization error: second-order in mean triangle edge length\nCirculation should remain constant (within discretization error) throughout the simulation\nDifferent midpoint methods (geometric, spline, cylindrical) should all conserve circulation","category":"section"},{"location":"validation/#Baroclinic-Validation-(Rayleigh–Taylor)","page":"Validation","title":"Baroclinic Validation (Rayleigh–Taylor)","text":"note: Linear Theory Comparison\nThese tests compare numerical results against analytical linear stability theory. Agreement validates the baroclinic source term implementation.","category":"section"},{"location":"validation/#Stable-Oscillation","page":"Validation","title":"Stable Oscillation","text":"For a sinusoidally-perturbed interface with lighter fluid above (A  0):\n\nParameter Value\nDomain [0:1]×[0:1]×[-4:4]\nPerturbation z = 001sin(2pi x)\nWavenumber k = 2pi\nBoussinesq coefficient theta = 1\nExpected period tau = 2pisqrt2pi approx 2507","category":"section"},{"location":"validation/#Unstable-Growth","page":"Validation","title":"Unstable Growth","text":"For heavier fluid above (A  0):\n\ntextMagnification = fracf_maxF_0 = cosh(tsqrt2pi)","category":"section"},{"location":"validation/#Convergence","page":"Validation","title":"Convergence","text":"M4' kernel: lowest errors, approximately second-order convergence for stable period\nArea-weighting and Peskin: approximately first-order convergence\nRegularization effect: longer periods (stable) and smaller growth rates (unstable) than theory","category":"section"},{"location":"validation/#Kelvin–Helmholtz-Instability","page":"Validation","title":"Kelvin–Helmholtz Instability","text":"warning: Regularization Effects\nThe regularization parameter delta^* significantly affects roll-up behavior. Higher resolution (smaller delta^*) produces sharper roll-up but requires finer grids.","category":"section"},{"location":"validation/#2D-Periodic-Shear-Layer","page":"Validation","title":"2D Periodic Shear Layer","text":"Setup following Krasny (1986) and Tryggvason (1989):\n\nz(xt=0) = 001sin(2pi x) quad gamma_y(xt=0) = 10\n\nDimensionless parameters:\n\ndelta^* = deltalambda: regularization length / wavelength\nTypical values: delta^* = 005 to 02\n\nExpected behavior:\n\nRoll-up time scales with delta^*\nHigher resolution (smaller delta^*) → sharper roll-up\nRegularization prevents finite-time singularity","category":"section"},{"location":"validation/#3D-Doubly-Periodic-Shear-Layer","page":"Validation","title":"3D Doubly-Periodic Shear Layer","text":"Including spanwise perturbation at the most unstable 3D mode (Pierrehumbert & Widnall, 1982):\n\nx = x + 001sin(2pi x) quad z = z + 001sin(2pi x) + 001sin(4pi y)\n\nExpected phenomena:\n\nInitial 2D roll-up\nDevelopment of streamwise ribs\n3D instability growth","category":"section"},{"location":"validation/#KH-with-Stabilizing-Stratification","page":"Validation","title":"KH with Stabilizing Stratification","text":"At the critical Richardson number (Ri_c = 14), the shear layer is marginally stable. Linear theory gives the growth rate:\n\nn = fracikDelta u(rho_2 - rho_1)2(rho_1 + rho_2) + sqrtfrack^2(Delta u)^2rho_1rho_2(rho_1+rho_2)^2 - fracgk(rho_2-rho_1)rho_1+rho_2","category":"section"},{"location":"validation/#Running-Validation-Tests","page":"Validation","title":"Running Validation Tests","text":"","category":"section"},{"location":"validation/#Kelvin–Helmholtz-(KH)-run","page":"Validation","title":"Kelvin–Helmholtz (KH) run","text":"Run the advanced example with MPI to produce a time-series JLD2 file with snapshots and (optionally) kinetic energy in the params:\n\nmpirun -n 4 julia --project examples/advanced_kh3d.jl\n\nBy default, it writes to checkpoints/advanced_series.jld2. You can change the output path in the example script if desired.","category":"section"},{"location":"validation/#Kinetic-energy-plot","page":"Validation","title":"Kinetic energy plot","text":"Use the provided plotting script to generate a KE vs time graphic into the docs assets. Set SERIES_FILE and OUTPUT_PNG:\n\nSERIES_FILE=checkpoints/advanced_series.jld2 \\\nOUTPUT_PNG=docs/src/assets/ke_series.png \\\njulia --project examples/plot_series_ke.jl\n\nThen reference it here:\n\n(Image: )","category":"section"},{"location":"validation/#Extracting-figures-from-the-thesis-(optional)","page":"Validation","title":"Extracting figures from the thesis (optional)","text":"If the thesis figures are available in mstock_dissertation.pdf, extract selected images using pdfimages (Poppler) or pdftoppm:\n\nmacOS (Homebrew): brew install poppler\nUbuntu/Debian: sudo apt-get install poppler-utils\n\nExtract embedded images:\n\npdfimages -png mstock_dissertation.pdf docs/src/assets/fig\n\nor rasterize specific pages to PNGs (e.g., pages 10–12):\n\npdftoppm -png -f 10 -l 12 mstock_dissertation.pdf docs/src/assets/page\n\nAfter saving, include figures in the appropriate pages (Theory/Remeshing/Parallelization). For the following thesis figure numbers, save with these suggested filenames:\n\n1.23 → docs/src/assets/fig123.png (Theory)\n3.19 → docs/src/assets/fig319.png (Theory/Parallelization)\n3.26 → docs/src/assets/fig326.png (Remeshing)\n3.52 → docs/src/assets/fig352.png (Remeshing)\n\n(Image: )","category":"section"},{"location":"validation/#Direct-page-extraction-(user-provided-pages)","page":"Validation","title":"Direct page extraction (user-provided pages)","text":"You shared the page numbers for these figures: 3.19, 1.23, 3.26, 3.52 → pages 90, 98, 118, 140.\n\nExtract at 300 dpi and save with the suggested filenames:\n\n# Figure 3.19 on page 90\npdftoppm -png -r 300 -f 90 -l 90 mstock_dissertation.pdf docs/src/assets/fig_3_19\nmv docs/src/assets/fig_3_19-090.png docs/src/assets/fig_3_19.png || \\\n  mv docs/src/assets/fig_3_19-90.png docs/src/assets/fig_3_19.png\n\n# Figure 1.23 on page 98\npdftoppm -png -r 300 -f 98 -l 98 mstock_dissertation.pdf docs/src/assets/fig_1_23\nmv docs/src/assets/fig_1_23-098.png docs/src/assets/fig_1_23.png || \\\n  mv docs/src/assets/fig_1_23-98.png docs/src/assets/fig_1_23.png\n\n# Figure 3.26 on page 118\npdftoppm -png -r 300 -f 118 -l 118 mstock_dissertation.pdf docs/src/assets/fig_3_26\nmv docs/src/assets/fig_3_26-118.png docs/src/assets/fig_3_26.png\n\n# Figure 3.52 on page 140\npdftoppm -png -r 300 -f 140 -l 140 mstock_dissertation.pdf docs/src/assets/fig_3_52\nmv docs/src/assets/fig_3_52-140.png docs/src/assets/fig_3_52.png","category":"section"},{"location":"validation/#Notes","page":"Validation","title":"Notes","text":"Ensure that any figure usage aligns with the thesis’ distribution rights.\nFor reproducibility, note the exact example parameters used to generate the series file.","category":"section"},{"location":"validation/#Results-(example-figures)","page":"Validation","title":"Results (example figures)","text":"Gamma magnitude snapshot:\n\nGenerate and embed a snapshot plot of |γ| at a chosen time (snapshot index):\n\nSERIES_FILE=checkpoints/advanced_series.jld2 \\\nSNAP_INDEX=10 \\\nOUTPUT_PNG=docs/src/assets/snapshot_gamma.png \\\njulia --project examples/plot_snapshot_gamma.jl\n\nThen include it here:\n\n(Image: )\n\nIf you share the thesis figure numbers/pages to include (and captions), we’ll add them directly to the relevant sections with proper references.","category":"section"},{"location":"dissipation/#Sub-Filter-Scale-Dissipation","page":"Dissipation Models","title":"Sub-Filter Scale Dissipation","text":"This page describes the sub-filter scale (SFS) dissipation models for Large Eddy Simulation (LES), based on Stock (2006), §3.8 and Mansfield et al. (1996).","category":"section"},{"location":"dissipation/#Motivation","page":"Dissipation Models","title":"Motivation","text":"info: Why Sub-Filter Dissipation?\nIn regularized vortex methods, the finite support of interpolation kernels acts as an implicit filter. Sub-filter scale motions are not resolved and must be modeled to prevent unphysical energy buildup.\n\nIn regularized vortex methods, the finite support of interpolation kernels acts as an implicit filter. Sub-filter scale motions are not resolved and their effects must be modeled to:\n\nProvide energy dissipation at small scales\nPrevent unphysical buildup of enstrophy\nEnable physically meaningful turbulence statistics","category":"section"},{"location":"dissipation/#Smagorinsky-Equivalent-Model","page":"Dissipation Models","title":"Smagorinsky-Equivalent Model","text":"The filtered vorticity evolution equation with SFS dissipation:\n\nfracDbaromega_iDt = barboldsymbolomega cdot nablabaru_i + nunabla^2baromega_i + nu_Tleft(fracpartialbaromega_ipartial x_jpartial x_j - fracpartialbaromega_jpartial x_ipartial x_jright)","category":"section"},{"location":"dissipation/#Eddy-Viscosity","page":"Dissipation Models","title":"Eddy Viscosity","text":"note: Smagorinsky Constant\nThe model constant c_T approx 015 is derived from analysis of isotropic turbulence. Values between 0.1–0.2 are commonly used depending on the flow configuration.\n\nThe turbulent (eddy) viscosity is computed from the filtered rate-of-strain:\n\nnu_T = (c_Tdelta)^2sqrt2barS_ijbarS_ij\n\nwhere:\n\nc_T approx 015 is the model constant (similar to Smagorinsky constant)\ndelta is the filter width (typically the regularization length)\nbarS_ij is the filtered rate-of-strain tensor","category":"section"},{"location":"dissipation/#Rate-of-Strain-Tensor","page":"Dissipation Models","title":"Rate-of-Strain Tensor","text":"barS_ij = frac12left(fracpartialbaru_ipartial x_j + fracpartialbaru_jpartial x_iright)\n\nThe magnitude is:\n\nbarS = sqrt2barS_ijbarS_ij","category":"section"},{"location":"dissipation/#Implementation","page":"Dissipation Models","title":"Implementation","text":"","category":"section"},{"location":"dissipation/#Lagrangian-to-Eulerian-to-Lagrangian-Approach","page":"Dissipation Models","title":"Lagrangian-to-Eulerian-to-Lagrangian Approach","text":"Compute vorticity on grid from Lagrangian elements (standard spreading)\nCompute velocity derivatives on the grid using finite differences\nCompute eddy viscosity at each grid point\nCompute vorticity diffusion term on the grid\nInterpolate change back to Lagrangian elements\n\nThis follows the grid-based approach from Mansfield et al. (1996), but interpolates back to existing elements instead of remeshing with replacement particles.","category":"section"},{"location":"dissipation/#Algorithm","page":"Dissipation Models","title":"Algorithm","text":"function apply_sfs_dissipation!(eleGma, tri, nodeX, nodeY, nodeZ, domain, gr, dt;\n                                 c_T=0.15, delta=nothing)\n    # Default filter width = grid spacing\n    delta = isnothing(delta) ? grid_spacing(domain, gr)[1] : delta\n\n    # 1. Spread vorticity to grid\n    VorX, VorY, VorZ = spread_vorticity_to_grid(eleGma, tri, nodeX, nodeY, nodeZ, domain, gr)\n\n    # 2. Solve for velocity field\n    Ux, Uy, Uz = poisson_velocity_fft(curl_rhs(VorX, VorY, VorZ, domain, gr)..., domain)\n\n    # 3. Compute velocity gradients\n    dudx, dudy, dudz = gradient(Ux, domain, gr)\n    dvdx, dvdy, dvdz = gradient(Uy, domain, gr)\n    dwdx, dwdy, dwdz = gradient(Uz, domain, gr)\n\n    # 4. Rate-of-strain magnitude\n    S_mag = compute_strain_magnitude(dudx, dudy, dudz, dvdx, dvdy, dvdz, dwdx, dwdy, dwdz)\n\n    # 5. Eddy viscosity field\n    nu_T = (c_T * delta)^2 .* S_mag\n\n    # 6. Vorticity diffusion (Laplacian)\n    dωdt_x = nu_T .* laplacian(VorX, domain, gr)\n    dωdt_y = nu_T .* laplacian(VorY, domain, gr)\n    dωdt_z = nu_T .* laplacian(VorZ, domain, gr)\n\n    # 7. Interpolate back to elements and update\n    update_element_vorticity!(eleGma, tri, nodeX, nodeY, nodeZ, dωdt_x, dωdt_y, dωdt_z, domain, gr, dt)\nend","category":"section"},{"location":"dissipation/#Rate-of-Strain-Computation","page":"Dissipation Models","title":"Rate-of-Strain Computation","text":"function compute_strain_magnitude(dudx, dudy, dudz, dvdx, dvdy, dvdz, dwdx, dwdy, dwdz)\n    # Sij = 0.5 * (dui/dxj + duj/dxi)\n    S11 = dudx\n    S22 = dvdy\n    S33 = dwdz\n    S12 = 0.5 * (dudy + dvdx)\n    S13 = 0.5 * (dudz + dwdx)\n    S23 = 0.5 * (dvdz + dwdy)\n\n    # |S| = sqrt(2 * Sij * Sij)\n    return sqrt.(2.0 .* (S11.^2 + S22.^2 + S33.^2 + 2.0*(S12.^2 + S13.^2 + S23.^2)))\nend","category":"section"},{"location":"dissipation/#Available-Dissipation-Models","page":"Dissipation Models","title":"Available Dissipation Models","text":"The VortexMethod.Dissipation module provides several models:","category":"section"},{"location":"dissipation/#NoDissipation-(Default)","page":"Dissipation Models","title":"NoDissipation (Default)","text":"No sub-filter dissipation. Suitable for:\n\nValidation against inviscid theory\nShort-duration simulations\nVery high resolution runs","category":"section"},{"location":"dissipation/#SmagorinskyModel","page":"Dissipation Models","title":"SmagorinskyModel","text":"Standard Smagorinsky model with constant c_T:\n\nmodel = SmagorinskyModel(c_T=0.15)\nrk2_step_with_dissipation!(nodes..., tri, eleGma, domain, gr, dt; dissipation_model=model)","category":"section"},{"location":"dissipation/#DynamicSmagorinsky","page":"Dissipation Models","title":"DynamicSmagorinsky","text":"Germano-style dynamic procedure to compute c_T locally:\n\nmodel = DynamicSmagorinsky(test_filter_ratio=2.0)\n\nThe dynamic model:\n\nComputes c_T from resolved scales\nReduces dissipation in laminar regions\nMore accurate for transitional flows","category":"section"},{"location":"dissipation/#VortexStretchingDissipation","page":"Dissipation Models","title":"VortexStretchingDissipation","text":"Dissipation proportional to local vortex stretching:\n\nmodel = VortexStretchingDissipation(c_stretch=0.1)\n\nTargets regions with intense vortex stretching, which often indicates under-resolved dynamics.","category":"section"},{"location":"dissipation/#MixedScaleModel","page":"Dissipation Models","title":"MixedScaleModel","text":"Combines strain-based and vorticity-based indicators:\n\nmodel = MixedScaleModel(c_strain=0.1, c_vorticity=0.1)","category":"section"},{"location":"dissipation/#Filter-Width-Selection","page":"Dissipation Models","title":"Filter Width Selection","text":"tip: Matching Kernel Support\nThe filter width delta should match the regularization scale of your chosen interpolation kernel. Using a mismatched filter width can lead to under- or over-dissipation.\n\nThe filter width delta should match the regularization scale:\n\nKernel Recommended delta\nArea-Weighting Delta x\nM4' 2Delta x\nPeskin (ε=2) 2Delta x\nPeskin (ε=3) 3Delta x\n\nUsing delta smaller than the kernel support can cause under-dissipation; larger values over-dissipate.","category":"section"},{"location":"dissipation/#Effect-on-Simulations","page":"Dissipation Models","title":"Effect on Simulations","text":"","category":"section"},{"location":"dissipation/#Without-SFS-Dissipation","page":"Dissipation Models","title":"Without SFS Dissipation","text":"warning: Energy Buildup\nWithout dissipation, energy accumulates at the grid scale, leading to unphysical noise and potentially unstable simulations.\n\nEnstrophy can grow unboundedly\nSmall-scale \"noise\" develops\nEnergy piles up at grid scale","category":"section"},{"location":"dissipation/#With-SFS-Dissipation","page":"Dissipation Models","title":"With SFS Dissipation","text":"Controlled enstrophy decay\nSmooth vorticity fields\nPhysical energy cascade","category":"section"},{"location":"dissipation/#Tuning-c_T","page":"Dissipation Models","title":"Tuning c_T","text":"Value Effect\n0.1 Light dissipation, preserves more small scales\n0.15 Standard value from isotropic turbulence\n0.2 Stronger dissipation, more stable but may be over-diffusive","category":"section"},{"location":"dissipation/#Integration-with-Time-Stepping","page":"Dissipation Models","title":"Integration with Time Stepping","text":"# Option 1: Use the combined function\nrk2_step_with_dissipation!(nodeX, nodeY, nodeZ, tri, eleGma, domain, gr, dt;\n                           dissipation_model=SmagorinskyModel(0.15))\n\n# Option 2: Apply separately\nrk2_step!(nodeX, nodeY, nodeZ, tri, eleGma, domain, gr, dt)\napply_dissipation!(eleGma, tri, nodeX, nodeY, nodeZ, domain, gr, dt;\n                   model=SmagorinskyModel(0.15))","category":"section"},{"location":"dissipation/#Validation","page":"Dissipation Models","title":"Validation","text":"","category":"section"},{"location":"dissipation/#Decaying-Isotropic-Turbulence","page":"Dissipation Models","title":"Decaying Isotropic Turbulence","text":"Compare energy decay rate E(t) sim t^-n with experimental/DNS values:\n\nWithout dissipation: n  1 (insufficient decay)\nWith Smagorinsky: n approx 12-14 (reasonable)","category":"section"},{"location":"dissipation/#Kelvin–Helmholtz-Roll-Up","page":"Dissipation Models","title":"Kelvin–Helmholtz Roll-Up","text":"Compare:\n\nRoll-up time\nMaximum vorticity\nMomentum thickness growth\n\nProperly tuned dissipation should not significantly delay roll-up but should prevent spurious secondary instabilities.","category":"section"},{"location":"dissipation/#References","page":"Dissipation Models","title":"References","text":"Mansfield, J. R., Knio, O. M., & Meneveau, C. (1996). A dynamic LES scheme for the vorticity transport equation. Part I: Formulation. Journal of Computational Physics, 126(1), 59–76.\nStock, M. J. (2006). A regularized inviscid vortex sheet method for three dimensional flows with density interfaces. Ph.D. Thesis, California Institute of Technology.\nSmagorinsky, J. (1963). General circulation experiments with the primitive equations. Monthly Weather Review, 91(3), 99–164.","category":"section"},{"location":"#VortexMethod.jl","page":"Home","title":"VortexMethod.jl","text":"A high-performance Julia implementation of the 3D Lagrangian vortex sheet method for simulating inviscid, incompressible flows with density interfaces.\n\n","category":"section"},{"location":"#Overview","page":"Home","title":"Overview","text":"This package implements the regularized vortex sheet method developed in Stock (2006). Key features:\n\n Feature Description\n1 Lagrangian Vortex Sheets Vorticity carried on triangulated surfaces with edge-based circulation discretization\n2 Vortex-in-Cell (VIC) Fast O(N log N) velocity computation via FFT-based Poisson solvers\n3 Adaptive Remeshing Edge splitting and node merging to maintain mesh quality\n4 Baroclinic Effects Vorticity generation at density interfaces (Rayleigh-Taylor, Richtmyer-Meshkov)\n5 Sub-filter Dissipation LES-style Smagorinsky models for turbulent flows\n6 MPI Parallelization Scalable spreading, interpolation, and communication\n\n","category":"section"},{"location":"#Documentation-Structure","page":"Home","title":"Documentation Structure","text":"Page Description\nTheory Governing equations, element discretization, interpolation kernels\nBoundary Conditions Periodic, open, and wall boundary treatments\nBaroclinic Effects Density discontinuities and vorticity generation\nDissipation Models Sub-filter scale dissipation for LES\nRemeshing Edge splitting, node merging, quality metrics\nParallelization MPI implementation details\nValidation Test cases and comparison with theory\nUsage Getting started and workflow examples\nAPI Function reference\n\n","category":"section"},{"location":"#Quick-Start","page":"Home","title":"Quick Start","text":"tip: Getting Started\nMake sure to run julia --project -e 'using Pkg; Pkg.instantiate()' before your first use.\n\nusing VortexMethod\n\n# Define domain and grid\ndomain = DomainSpec(1.0, 1.0, 4.0)  # Lx, Ly, Lz\ngr = GridSpec(64, 64, 256)          # nx, ny, nz\n\n# Initialize sheet (nodes and triangles)\nnodeX, nodeY, nodeZ, tri = create_initial_sheet(...)\neleGma = initialize_vortex_strength(tri, ...)\n\n# Time stepping with MPI\ndt = 0.01\nfor step in 1:nsteps\n    rk2_step!(nodeX, nodeY, nodeZ, tri, eleGma, domain, gr, dt)\n    remesh_pass!(nodeX, nodeY, nodeZ, tri, ds_max, ds_min; domain)\n    wrap_nodes!(nodeX, nodeY, nodeZ, domain)\nend\n\nnote: MPI Support\nFor parallel execution, launch with mpirun -n <nprocs> julia --project your_script.jl\n\n","category":"section"},{"location":"#Key-References","page":"Home","title":"Key References","text":"Primary Reference: Stock, M. J. (2006). A regularized inviscid vortex sheet method for three dimensional flows with density interfaces. Ph.D. Thesis, California Institute of Technology.\n\nAdditional Reading: Cottet, G.-H., & Koumoutsakos, P. D. (2000). Vortex Methods: Theory and Practice. Cambridge University Press.\n\n\n\n","category":"section"},{"location":"#Notes-on-Remeshing-and-Metrics","page":"Home","title":"Notes on Remeshing and Metrics","text":"Periodic metrics: Advanced remeshing and sheet quality now use periodic, minimum-image geometry in x/y and symmetric in z ([-Lz,Lz]).\nThresholds (defaults):\nmaxaspectratio=3.0, max_skewness=0.8\nminanglequality=0.4, minjacobianquality=0.4\ngradthreshold=0.2 (Frobenius norm of ∇U), curvaturethreshold=0.6 rad\nKernel-based interpolation options are available via Kernels.\nNew helper: grid_velocity(eleGma, triXC, triYC, triZC, domain, gr) computes (Ux,Uy,Uz) for reuse.","category":"section"},{"location":"#Tuning-Thresholds","page":"Home","title":"Tuning Thresholds","text":"Coarser meshes typically require looser thresholds (e.g., AR≤4.0) to avoid over-refinement; finer meshes can tolerate tighter thresholds (e.g., AR≤3.0).\nSet grad_threshold proportional to expected shear; use a smaller value for gentle flows and larger for strongly sheared layers.\ncurvature_threshold is a dihedral angle; values around 0.5–0.8 rad (≈29–46°) work well for sheet roll-up detection.\nYou can pass these per-call via flow_adaptive_remesh! or rely on the defaults.","category":"section"},{"location":"#Velocity-Reuse","page":"Home","title":"Velocity Reuse","text":"Use make_velocity_sampler(eleGma, triXC, triYC, triZC, domain, gr) to build a closure (x,y,z)->(u,v,w) backed by a single spread/Poisson solve.\nThis reduces repeated Poisson solves during remeshing and sheet tracking in the same time step.","category":"section"},{"location":"baroclinic/#Baroclinic-Vorticity-Generation","page":"Baroclinic Effects","title":"Baroclinic Vorticity Generation","text":"This page describes the treatment of density discontinuities and baroclinic vorticity generation, based on Stock (2006), §3.7.","category":"section"},{"location":"baroclinic/#Physical-Background","page":"Baroclinic Effects","title":"Physical Background","text":"info: Baroclinic Vorticity Generation\nWhen a density interface exists in a flow under acceleration (gravity or otherwise), vorticity is generated at the interface. This baroclinic mechanism drives important instabilities like Rayleigh–Taylor and Richtmyer–Meshkov.\n\nWhen a density interface exists in a flow under acceleration (gravity or otherwise), vorticity is generated at the interface. This baroclinic mechanism drives important instabilities:\n\nRayleigh–Taylor instability: Heavy fluid over light fluid under gravity\nRichtmyer–Meshkov instability: Shock-accelerated density interface\nKelvin–Helmholtz with stratification: Shear layer with stabilizing/destabilizing buoyancy","category":"section"},{"location":"baroclinic/#Boussinesq-Approximation","page":"Baroclinic Effects","title":"Boussinesq Approximation","text":"note: Small Density Differences\nThe Boussinesq approximation assumes density differences are small (A ll 1), so inertia is dominated by the mean density while buoyancy depends on the density difference.\n\nIn the Boussinesq limit (small density differences), the baroclinic source term in the vortex sheet strength equation is:\n\nleft(fracDboldsymbolgammaDtright)_textbaroclinic = 2Ahatmathbfn times (barmathbfa - mathbfg)\n\nwhere:\n\nA = (rho_2 - rho_1)(rho_1 + rho_2) is the Atwood number\nhatmathbfn is the interface normal (pointing from fluid 1 to fluid 2)\nbarmathbfa is the average interface acceleration\nmathbfg is gravitational acceleration\n\nThe corresponding circulation equation:\n\nfracDGammaDt = 2Aleft(fracDphiDt - frac12mathbfu^2 + frac18Deltamathbfu^2 - mathbfgcdotmathbfxright)","category":"section"},{"location":"baroclinic/#Implementation","page":"Baroclinic Effects","title":"Implementation","text":"","category":"section"},{"location":"baroclinic/#Element-Data-Structure","page":"Baroclinic Effects","title":"Element Data Structure","text":"Each triangular element stores its own local Atwood number. All elements in an interconnected sheet share the same value, though separate sheets may have different values.","category":"section"},{"location":"baroclinic/#Vorticity-Update","page":"Baroclinic Effects","title":"Vorticity Update","text":"For each element i at the density interface:\n\nDeltaboldsymbolalpha_i = Delta t cdot 2a_itheta_ihatmathbfn_i times hatmathbfg\n\nwhere:\n\na_i is the element area\ntheta_i = A cdot g is the Boussinesq coefficient (Atwood number × gravity)\nhatmathbfn_i is the element normal\nhatmathbfg is the gravity direction\n\nThis vector change in total vorticity is converted to edge circulations using the standard procedure (see Theory).","category":"section"},{"location":"baroclinic/#Integration-with-Time-Stepping","page":"Baroclinic Effects","title":"Integration with Time Stepping","text":"Baroclinic updates are applied at every sub-step of the time integration:\n\nfunction rk2_step_with_baroclinic!(nodes, tri, eleGma, domain, gr, dt; atwood=0.0, gravity=[0,0,-1])\n    # Stage 1: Compute velocities\n    vel1 = node_velocities(eleGma, tri, nodes..., domain, gr)\n\n    # Update positions to midpoint\n    nodes_mid = nodes .+ 0.5 * dt .* vel1\n\n    # Baroclinic source at midpoint\n    if atwood != 0\n        apply_baroclinic_source!(eleGma, tri, nodes_mid, atwood, gravity, 0.5*dt)\n    end\n\n    # Stage 2: Compute velocities at midpoint\n    vel2 = node_velocities(eleGma, tri, nodes_mid..., domain, gr)\n\n    # Full step\n    nodes .+= dt .* vel2\n\n    # Baroclinic source for full step\n    if atwood != 0\n        apply_baroclinic_source!(eleGma, tri, nodes, atwood, gravity, 0.5*dt)\n    end\nend","category":"section"},{"location":"baroclinic/#Validation:-Linear-Theory-Comparison","page":"Baroclinic Effects","title":"Validation: Linear Theory Comparison","text":"","category":"section"},{"location":"baroclinic/#Stable-Oscillation-(Light-over-Heavy)","page":"Baroclinic Effects","title":"Stable Oscillation (Light over Heavy)","text":"For A  0 (lighter fluid on top), a sinusoidally-perturbed interface oscillates:\n\nf(xt) = F_0 exp(ikx + itsqrtthetak)\n\nwith period:\n\ntau = frac2pisqrtthetak","category":"section"},{"location":"baroclinic/#Unstable-Growth-(Heavy-over-Light)","page":"Baroclinic Effects","title":"Unstable Growth (Heavy over Light)","text":"For A  0 (heavier fluid on top, or heavy over light with gravity reversed), the amplitude grows exponentially:\n\nf_max = F_0 cosh(tsqrtthetak)","category":"section"},{"location":"baroclinic/#Test-Setup","page":"Baroclinic Effects","title":"Test Setup","text":"# Computational domain [0:1]×[0:1]×[-4:4]\n# Periodic in x,y; wall in z\ndomain = DomainSpec(1.0, 1.0, 8.0)\ngr = GridSpec(15, 15, 120)  # or finer\n\n# Initial perturbation: z = 0.01 sin(2πx) → k = 2π\n# Boussinesq coefficient θ = 1\n\n# Expected period (stable case):\nτ_theory = 2π / √(2π)  # ≈ 2.507\n\n# Expected growth (unstable case):\nmagnification(t) = cosh(t * √(2π))","category":"section"},{"location":"baroclinic/#Convergence","page":"Baroclinic Effects","title":"Convergence","text":"tip: Kernel Selection\nThe M4' kernel provides the lowest errors for baroclinic validation. Area-weighting and Peskin kernels show approximately first-order convergence.\n\nThe method shows approximately first-order convergence to analytical limits, with the M4' kernel providing lowest errors. Regularization causes:\n\nLonger oscillation periods than theory (smoother = slower)\nSmaller unstable growth rates than theory (regularization damps peaks)","category":"section"},{"location":"baroclinic/#Multi-Sheet-Simulations","page":"Baroclinic Effects","title":"Multi-Sheet Simulations","text":"Simulations can contain multiple separate vortex sheets, each with its own Atwood number:\n\n# Example: Two-layer stratification\nsheets = [\n    (tri=tri_upper, eleGma=eleGma_upper, atwood=0.1),   # Upper interface\n    (tri=tri_lower, eleGma=eleGma_lower, atwood=-0.1),  # Lower interface\n]\n\nfor sheet in sheets\n    apply_baroclinic_source!(sheet.eleGma, sheet.tri, nodes, sheet.atwood, gravity, dt)\nend","category":"section"},{"location":"baroclinic/#Kelvin–Helmholtz-with-Stratification","page":"Baroclinic Effects","title":"Kelvin–Helmholtz with Stratification","text":"Combining shear (initial vortex sheet strength) with stratification:","category":"section"},{"location":"baroclinic/#Linear-Growth-Rate","page":"Baroclinic Effects","title":"Linear Growth Rate","text":"From Chandrasekhar (1961):\n\nn = fracikDelta u(rho_2 - rho_1)2(rho_1 + rho_2) + sqrtfrack^2(Delta u)^2rho_1rho_2(rho_1+rho_2)^2 - fracgk(rho_2-rho_1)rho_1+rho_2","category":"section"},{"location":"baroclinic/#Stability-Criterion","page":"Baroclinic Effects","title":"Stability Criterion","text":"warning: Richardson Number\nAt the critical Richardson number Ri_c = 14, the shear layer transitions from stable to unstable. Below this value, shear dominates buoyancy.\n\nThe interface is unstable when:\n\nk(Delta u)^2  fracg(rho_2 - rho_1)(rho_1 + rho_2)rho_1rho_2\n\nAt the critical Richardson number, Ri_c = 14, the shear layer is marginally stable.","category":"section"},{"location":"baroclinic/#API-Reference","page":"Baroclinic Effects","title":"API Reference","text":"# Apply baroclinic vorticity source\napply_baroclinic_source!(eleGma, tri, nodeX, nodeY, nodeZ, atwood, gravity, dt)\n\n# Time stepping with baroclinic terms\nrk2_step!(nodeX, nodeY, nodeZ, tri, eleGma, domain, gr, dt;\n          baroclinic=true, atwood=0.1, gravity=[0.0, 0.0, -1.0])","category":"section"},{"location":"baroclinic/#References","page":"Baroclinic Effects","title":"References","text":"Chandrasekhar, S. (1961). Hydrodynamic and Hydromagnetic Stability. Oxford University Press.\nStock, M. J. (2006). A regularized inviscid vortex sheet method for three dimensional flows with density interfaces. Ph.D. Thesis, California Institute of Technology.\nZalosh, R. G. (1976). Discretized simulation of vortex sheet evolution with buoyancy and surface tension effects. AIAA Journal, 14(11), 1517–1523.","category":"section"},{"location":"boundary_conditions/#Boundary-Conditions","page":"Boundary Conditions","title":"Boundary Conditions","text":"This page describes the treatment of boundary conditions for the vortex-in-cell method, based on Stock (2006), §3.3.2–3.3.5.","category":"section"},{"location":"boundary_conditions/#Overview","page":"Boundary Conditions","title":"Overview","text":"info: Boundary Condition Categories\nFlow simulations fall under two categories based on their boundaries: internal flows (bounded by walls) and external flows (periodic or extending to infinity).\n\nFlow simulations fall under two categories based on their boundaries:\n\nType Boundary Conditions Applications\nInternal Wall (slip or no-slip) Channel flows, cavity flows\nExternal Periodic or free-space (open) Mixing layers, jets, wakes\n\nThe Poisson solver (HW3CRT/FFT) supports Dirichlet, Neumann, or periodic boundary conditions, enabling uniform inlet, wall, periodic, or open boundaries.","category":"section"},{"location":"boundary_conditions/#Periodic-Boundaries","page":"Boundary Conditions","title":"Periodic Boundaries","text":"Periodic boundary conditions are commonly used to mimic free-space or to study spatially-developing instabilities.","category":"section"},{"location":"boundary_conditions/#Element-Treatment","page":"Boundary Conditions","title":"Element Treatment","text":"warning: Straddling Elements\nBecause we use triangular elements with connectivity, extra care is required when elements \"straddle\" a periodic boundary. Failing to handle these correctly leads to incorrect vorticity spreading and interpolation.\n\nBecause we use triangular elements with connectivity, extra care is required when elements \"straddle\" a periodic boundary:\n\nStraddling Detection: For each element, check if any two nodes are separated by more than 25Delta x in a periodic direction\nCorrection: Temporarily move nodes near the upper boundary down by one domain length\nOperation: Perform calculations (area, normal, center, spreading)\nRestoration: Return nodes to their \"natural\" positions","category":"section"},{"location":"boundary_conditions/#Vorticity-Field-Creation","page":"Boundary Conditions","title":"Vorticity Field Creation","text":"When spreading vorticity near periodic boundaries:\n\nGrid nodes are indexed 0N, with index N representing index 0 of the next domain\nVorticity at node i_textnode  0 is added to i_textnode + N\nVorticity at node i_textnode  N-1 is added to i_textnode - N\nAfter spreading, copy vorticity at index 0 to index N for consistency\n\n# Periodic wrap for vorticity spreading\nfunction periodic_wrap_index(inode, N)\n    if inode < 0\n        return inode + N\n    elseif inode > N - 1\n        return inode - N\n    else\n        return inode\n    end\nend","category":"section"},{"location":"boundary_conditions/#Usage","page":"Boundary Conditions","title":"Usage","text":"using VortexMethod\n\n# Create domain with periodic x and y\ndomain = DomainSpec(1.0, 1.0, 4.0)  # Lx, Ly, Lz\ngr = GridSpec(64, 64, 256)\n\n# Wrap nodes after any modification\nwrap_nodes!(nodeX, nodeY, nodeZ, domain)","category":"section"},{"location":"boundary_conditions/#Open-(Free-Space)-Boundaries","page":"Boundary Conditions","title":"Open (Free-Space) Boundaries","text":"note: Complexity\nOpen boundaries allow vorticity to influence the flow beyond the computational domain. Implementation is more complex than periodic boundaries because boundary values must be computed from the interior vorticity field.\n\nOpen boundaries allow vorticity to influence the flow beyond the computational domain. Implementation is more complex than periodic boundaries.","category":"section"},{"location":"boundary_conditions/#Dirichlet-Boundary-Values","page":"Boundary Conditions","title":"Dirichlet Boundary Values","text":"When no vorticity is near open boundaries, use Dirichlet conditions with boundary velocities computed via direct Biot-Savart summation:\n\nmathbfu(mathbfx_textboundary) = sum_textinterior cells fracboldsymbolomega times (mathbfx_textboundary - mathbfx_textcell)4pimathbfx_textboundary - mathbfx_textcell^3\n\nOptimization: Integrate over every 4th boundary node and interpolate the rest. Only sum over cells with non-zero vorticity.","category":"section"},{"location":"boundary_conditions/#Kinetic-Energy-Calculation","page":"Boundary Conditions","title":"Kinetic Energy Calculation","text":"For open boundaries, kinetic energy requires special treatment because velocity is only computed inside the domain. Using the divergence theorem, assuming potential flow outside:\n\nE = frac12leftint_V mathbfu^2dmathbfx + int_S phi(mathbfucdotmathbfn)dAright\n\nwhere phi is a scalar velocity potential computed on the boundary.","category":"section"},{"location":"boundary_conditions/#Element-Entry/Exit","page":"Boundary Conditions","title":"Element Entry/Exit","text":"Elements crossing open boundaries require special handling—either removing them or using absorbing layers. Current simulations are designed to avoid this situation.","category":"section"},{"location":"boundary_conditions/#Wall-Boundaries-(Slip)","page":"Boundary Conditions","title":"Wall Boundaries (Slip)","text":"tip: High-Reynolds-Number Approximation\nFor high-Reynolds-number flows, wall-generated vorticity stays within a thin boundary layer, allowing slip-wall treatment. This avoids resolving the viscous sublayer while maintaining correct inviscid behavior.\n\nFor high-Reynolds-number flows, wall-generated vorticity stays within a thin boundary layer, allowing slip-wall treatment.","category":"section"},{"location":"boundary_conditions/#Vorticity-Near-Walls","page":"Boundary Conditions","title":"Vorticity Near Walls","text":"When elements are within the regularization distance of a wall:\n\nOn the wall (i_textnode = 0 or N):\n\nDouble the wall-normal vorticity component\nZero the wall-tangential components\n\nBeyond the wall (i_textnode  0 or  N):\n\nReflect to i_textnode to -i_textnode or 2N - i_textnode\nZero the normal component\nNegate the tangential components (image vorticity)\n\nThis ensures near-wall vortex lines are smoothed as if they and their reflections existed.","category":"section"},{"location":"boundary_conditions/#Boundary-Conditions-for-Poisson-Solve","page":"Boundary Conditions","title":"Boundary Conditions for Poisson Solve","text":"Normal velocity: u_n = 0 (no penetration)\nTangential velocity derivative: partial u_t  partial n = 0 (free slip)","category":"section"},{"location":"boundary_conditions/#Element-Wall-Interaction","page":"Boundary Conditions","title":"Element-Wall Interaction","text":"Two types of vortex sheet–wall interactions:\n\nEdge attached to wall: The edge must stay on the wall; nodes within epsilon = 10^-5 of the wall are constrained to remain there\nSheet approaching wall: Handled by the image vorticity treatment described above","category":"section"},{"location":"boundary_conditions/#Special-Boundary-Conditions","page":"Boundary Conditions","title":"Special Boundary Conditions","text":"","category":"section"},{"location":"boundary_conditions/#Inlet/Outlet-(Jets,-Mixing-Layers)","page":"Boundary Conditions","title":"Inlet/Outlet (Jets, Mixing Layers)","text":"For circular jets or mixing layers:\n\nModify normal velocity component at inlet\nInsert shedding edges manually (see [Stock (2006), §3.6])","category":"section"},{"location":"boundary_conditions/#Traveling-Window","page":"Boundary Conditions","title":"Traveling Window","text":"For problems like propagating vortex rings, the computational domain can \"follow\" the structure:\n\n# Domain moves with sheet centroid\ndomain_z_min = sheet_centroid_z - 2.0\ndomain_z_max = sheet_centroid_z + 2.0","category":"section"},{"location":"boundary_conditions/#Boundary-Condition-Selection-Guide","page":"Boundary Conditions","title":"Boundary Condition Selection Guide","text":"Flow Type Recommended BCs Notes\nPeriodic instability (KH, RT) Periodic in x,y; wall in z Most common setup\nFree vortex ring Open in all directions Use traveling window\nChannel flow Wall in y; periodic in x,z Standard internal flow\nJet in crossflow Inlet + open Complex setup\nMixing layer Periodic in x,y; open in z Matches experiment","category":"section"},{"location":"boundary_conditions/#References","page":"Boundary Conditions","title":"References","text":"Stock, M. J. (2006). A regularized inviscid vortex sheet method for three dimensional flows with density interfaces. Ph.D. Thesis, California Institute of Technology.\nSwarztrauber, P., & Sweet, R. (1975). Efficient FORTRAN subprograms for the solution of elliptic partial differential equations. NCAR Technical Note.","category":"section"}]
}
